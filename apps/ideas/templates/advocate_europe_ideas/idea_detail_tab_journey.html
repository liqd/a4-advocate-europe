{% load i18n rules static micawber_tags %}

<div class="ideadetail-tab">
    <div class="ideadetailtab-header">
        <h2>{% trans "Reporting" %}</h2>
    </div>
    {% has_perm 'advocate_europe_ideas.add_journey' request.user idea as can_write_journey %}
    {% if can_write_journey %}
        <a class="btn btn-primary journey-btn" href="{% url 'journey-entry-create' idea.slug %}">{% trans "New entry" %}</a>
    {% endif %}
    <div class="journey">
    {% if idea.journeyentry_set.all.count == 0 %}
        <h3>{% trans 'No entries yet' %}</h3>
    {% else %}
    {% for entry in idea.journeyentry_set.all %}
        <div class="journey-entry">
            <span class="journey-category">{{ entry.get_category_display }}</span>
            <h3>{{ entry.title }}</h3>
            <div>{{ entry.text | oembed_html }}</div>
            <div>
                <span class="avatar-round-small" style="background-image: url({{ entry.creator.avatar_or_fallback_url }})"></span>
                <span class="collaborator"><a class="collaborator-link" href="{% url 'profile' entry.creator.username %}">{{ entry.creator.username }} </a>{% trans 'on' %} {{ entry.created | date }}</span>
                {% if can_write_journey %}
                <a class="btn btn-link journey-link" href="{% url 'journey-entry-update' entry.pk %}">{% trans "Edit" %}</a>
                <form class="d-inline" method="POST" id="entry_delete" action="{% url 'journey-entry-delete' entry.pk %}">
                {% csrf_token %}
                    <button type="submit" class="submit-button btn btn-link journey-link">{% trans 'Delete'%}</button>
                </form>
                {% endif %}
            </div>
        </div>
    {% endfor %}
    {% endif %}
    </div>
</div>
