#!/bin/sh

set -e -v

if [ -n ${TRAVIS_SSH_SECRET} ]; then
    SSH_ID_ARG="-i ${HOME}/id_rsa"
    cat <<EOF | openssl enc -d -pass env:TRAVIS_SSH_SECRET -aes256 -a -out ~/id_rsa
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
Phv81R9+GrYMFTZQqPyp/w==
EOF
    chmod 600 ~/id_rsa
fi

ssh -p 22036 ${SSH_ID_ARG} -oStrictHostKeyChecking=no build@benhabib.liqd.net deploy advocate_europe master
