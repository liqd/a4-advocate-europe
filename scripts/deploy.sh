#!/bin/sh

set -e -v

if [ -n ${TRAVIS_SSH_SECRET} ]; then
    SSH_ID_ARG="-i ${HOME}/id_rsa"
    cat <<EOF | openssl enc -d -pass env:TRAVIS_SSH_SECRET -aes256 -a -out ~/id_rsa
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
EOF
    chmod 600 ~/id_rsa
fi

ssh -p 22036 ${SSH_ID_ARG} -oStrictHostKeyChecking=no build@benhabib.liqd.net deploy advocate_europe master
